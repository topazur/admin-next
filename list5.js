import{A as k}from"./Add12Filled.js";import{D as T}from"./Delete16Regular.js";import{T as C}from"./index3.js";import{R as I}from"./relative-time.js";import{u as P}from"./use-table.js";import{R as b,p as B,d as O,a as $}from"./index.js";import{d as E,G as z,z as N,ag as U,w as L,o as M,aU as H,h as l,T as W,aV as K,A as x,B as V,aW as G,F as Q}from"./vendor.js";import{H as j}from"./rounded-button.js";function v(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(r){return typeof r}:v=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},v(e)}function F(e){var t=typeof e=="string"||e instanceof String;if(!t){var r=v(e);throw e===null?r="null":r==="object"&&(r=e.constructor.name),new TypeError("Expected a string but received a ".concat(r))}}function S(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var r in t)typeof e[r]=="undefined"&&(e[r]=t[r]);return e}var Z={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1};function J(e,t){F(e),t=S(t,Z),t.allow_trailing_dot&&e[e.length-1]==="."&&(e=e.substring(0,e.length-1)),t.allow_wildcard===!0&&e.indexOf("*.")===0&&(e=e.substring(2));var r=e.split("."),n=r[r.length-1];return t.require_tld&&(r.length<2||!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(n)||/\s/.test(n))||!t.allow_numeric_tld&&/^\d+$/.test(n)?!1:r.every(function(u){return!(u.length>63||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(u)||/[\uff01-\uff5e]/.test(u)||/^-|-$/.test(u)||!t.allow_underscores&&/_/.test(u))})}var R="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",g="(".concat(R,"[.]){3}").concat(R),X=new RegExp("^".concat(g,"$")),o="(?:[0-9a-fA-F]{1,4})",Y=new RegExp("^("+"(?:".concat(o,":){7}(?:").concat(o,"|:)|")+"(?:".concat(o,":){6}(?:").concat(g,"|:").concat(o,"|:)|")+"(?:".concat(o,":){5}(?::").concat(g,"|(:").concat(o,"){1,2}|:)|")+"(?:".concat(o,":){4}(?:(:").concat(o,"){0,1}:").concat(g,"|(:").concat(o,"){1,3}|:)|")+"(?:".concat(o,":){3}(?:(:").concat(o,"){0,2}:").concat(g,"|(:").concat(o,"){1,4}|:)|")+"(?:".concat(o,":){2}(?:(:").concat(o,"){0,3}:").concat(g,"|(:").concat(o,"){1,5}|:)|")+"(?:".concat(o,":){1}(?:(:").concat(o,"){0,4}:").concat(g,"|(:").concat(o,"){1,6}|:)|")+"(?::((?::".concat(o,"){0,5}:").concat(g,"|(?::").concat(o,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");function h(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(F(e),t=String(t),!t)return h(e,4)||h(e,6);if(t==="4"){if(!X.test(e))return!1;var r=e.split(".").sort(function(n,u){return n-u});return r[3]<=255}return t==="6"?!!Y.test(e):!1}function ee(e,t){return ne(e)||ae(e,t)||re(e,t)||te()}function te(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function re(e,t){if(!!e){if(typeof e=="string")return q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q(e,t)}}function q(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ae(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,u=!1,m=void 0;try{for(var f=e[Symbol.iterator](),s;!(n=(s=f.next()).done)&&(r.push(s.value),!(t&&r.length===t));n=!0);}catch(a){u=!0,m=a}finally{try{!n&&f.return!=null&&f.return()}finally{if(u)throw m}}return r}}function ne(e){if(Array.isArray(e))return e}var ue={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},oe=/^\[([^\]]+)\](?::([0-9]+))?$/;function ie(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(e===n||ie(n)&&n.test(e))return!0}return!1}function le(e,t){if(F(e),!e||/[\s<>]/.test(e)||e.indexOf("mailto:")===0||(t=S(t,ue),t.validate_length&&e.length>=2083)||!t.allow_fragments&&e.includes("#")||!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var r,n,u,m,f,s,a,d;if(a=e.split("#"),e=a.shift(),a=e.split("?"),e=a.shift(),a=e.split("://"),a.length>1){if(r=a.shift().toLowerCase(),t.require_valid_protocol&&t.protocols.indexOf(r)===-1)return!1}else{if(t.require_protocol)return!1;if(e.substr(0,2)==="//"){if(!t.allow_protocol_relative_urls)return!1;a[0]=e.substr(2)}}if(e=a.join("://"),e==="")return!1;if(a=e.split("/"),e=a.shift(),e===""&&!t.require_host)return!0;if(a=e.split("@"),a.length>1){if(t.disallow_auth||a[0]===""||(n=a.shift(),n.indexOf(":")>=0&&n.split(":").length>2))return!1;var _=n.split(":"),y=ee(_,2),c=y[0],i=y[1];if(c===""&&i==="")return!1}m=a.join("@"),s=null,d=null;var p=m.match(oe);if(p?(u="",d=p[1],s=p[2]||null):(a=m.split(":"),u=a.shift(),a.length&&(s=a.join(":"))),s!==null&&s.length>0){if(f=parseInt(s,10),!/^[0-9]+$/.test(s)||f<=0||f>65535)return!1}else if(t.require_port)return!1;return t.host_whitelist?D(u,t.host_whitelist):!(!h(u)&&!J(u,t)&&(!d||!h(d,6))||(u=u||d,t.host_blacklist&&D(u,t.host_blacklist)))}const ye=E({setup(e,t){const{checkedRowKeys:r,data:n,pager:u,sortProps:m,fetchDataFn:f}=P((c,i)=>async(p=d.query.page||1,w=30)=>{const A=await b.api.projects.get({params:{page:p,size:w}});c.value=A.data,i.value=A.pagination}),s=z(),a=N(),d=U(),_=f;L(()=>d.query.page,async c=>{await _(c)}),M(async()=>{await _()});const y=E({setup(){const c=H([{type:"selection",options:["none","all"]},{title:"\u9879\u76EE\u540D\u79F0",key:"name",width:100,render(i){const p=[i.previewUrl,i.projectUrl,i.docUrl].filter(Boolean).find(w=>le(w,{require_protocol:!0}));return p?l("a",{href:p,target:"_blank",rel:"noreferrer"},i.name):l(W,null,i.name)}},{title:"\u9879\u76EE\u63CF\u8FF0",key:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"created",render(i){return B(i.created)}},{title:"\u4FEE\u6539\u4E8E",key:"created",render(i){return l(I,{time:i.created})}},{title:"\u64CD\u4F5C",fixed:"right",key:"id",width:130,render(i){return l(V,{wrap:!1},l(K,{to:{name:O.EditProject,query:{id:i.id}}},l(x,{text:!0,type:"primary",size:"tiny"},"\u7F16\u8F91")),l(G,{positiveText:"\u53D6\u6D88",negativeText:"\u5220\u9664",onNegativeClick:async()=>{await b.api.projects(i.id).delete(),s.success("\u5220\u9664\u6210\u529F"),await _(u.value.currentPage)}},{trigger:()=>l(x,{text:!0,type:"error",size:"tiny"},"\u79FB\u9664"),default:()=>l("span",{style:{maxWidth:"12rem"}},"\u786E\u5B9A\u8981\u5220\u9664\u9879\u76EE [",i.name,"] ?")}))}}]);return()=>l(C,{columns:c,data:n,onFetchData:_,pager:u,onUpdateCheckedRowKeys:i=>{r.value=i}})}});return()=>l($,null,{actions:()=>l(Q,null,l(j,{variant:"error",disabled:r.value.length==0,onClick:()=>{a.warning({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u4E0D\u786E\u5B9A",onPositiveClick:async()=>{for(const c of r.value)await b.api.projects(c).delete();r.value.length=0,s.success("\u5220\u9664\u6210\u529F"),await _()}})},icon:l(T,null)}),l(j,{to:"/projects/edit",icon:l(k,null)})),default:()=>l(y,null)})}});export{ye as default};
